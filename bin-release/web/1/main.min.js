var __reflect=this&&this.__reflect||function(e,t,n){e.__class__=t,n?n.push(t):n=[t],e.__types__=e.__types__?n.concat(e.__types__):n},__extends=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},EggUI=function(e){function t(){var t=e.call(this)||this;return t.roleType=RoleType.egg,t.initView(),t}return __extends(t,e),t.prototype.initView=function(){var t=Helper.getBitmap(R.egg_png);e.prototype.addChild.call(this,t)},t}(egret.Sprite);__reflect(EggUI.prototype,"EggUI");var TapEvent=function(e){function t(t,n,i){return void 0===n&&(n=!1),void 0===i&&(i=!1),e.call(this,t,n,i)||this}return __extends(t,e),t}(egret.Event);TapEvent.NAME="TapEvent",__reflect(TapEvent.prototype,"TapEvent");var Main=function(e){function t(){var t=e.call(this)||this;return t.addEventListener(egret.Event.ADDED_TO_STAGE,t.onAddToStage,t),t}return __extends(t,e),t.prototype.onAddToStage=function(e){RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/")},t.prototype.onConfigComplete=function(e){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),RES.loadGroup("load")},t.prototype.onResourceLoadComplete=function(e){"load"==e.groupName&&(this.loadingView=new LoadingUI,this.stage.addChild(this.loadingView),egret.Tween.get(this.loadingView).wait(3e3).call(function(){RES.loadGroup("preload")})),"preload"==e.groupName&&(this.stage.removeChild(this.loadingView),RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),this.createGameScene())},t.prototype.onItemLoadError=function(e){console.warn("Url:"+e.resItem.url+" has failed to load")},t.prototype.onResourceLoadError=function(e){console.warn("Group:"+e.groupName+" has failed to load"),this.onResourceLoadComplete(e)},t.prototype.createGameScene=function(){Helper.width=this.stage.stageWidth,Helper.height=this.stage.stageHeight,this.stage.scaleMode=egret.StageScaleMode.NO_BORDER,this.addBeginUI(),RES.loadGroup("gameui")},t.prototype.addBeginUI=function(){var e=this;BeginUI.addBeginUI(this,function(){e.addGameUI()})},t.prototype.addGameUI=function(){var e=this;RES.loadGroup("regameui"),GameUI.addGameUI(this,function(){e.addBeginUI()})},t}(egret.DisplayObjectContainer);__reflect(Main.prototype,"Main");var BarUI=function(e){function t(){var t=e.call(this)||this;return t.initView(),t}return __extends(t,e),t.prototype.initView=function(){var t=Helper.getBitmap(R.great_bg_png);Helper.ObjectCenterX(t),t.y+=30,e.prototype.addChild.call(this,t),this.markTxt=new egret.TextField,this.markTxt.y+=45,this.markTxt.x=250,e.prototype.addChild.call(this,this.markTxt),this.timeTxt=new egret.TextField,this.timeTxt.y+=45,this.timeTxt.x=520,e.prototype.addChild.call(this,this.timeTxt)},t}(egret.Sprite);__reflect(BarUI.prototype,"BarUI");var BeginUI=function(e){function t(){var t=e.call(this)||this;return t.tabEvent=new TapEvent(TapEvent.NAME),t.initView(),t}return __extends(t,e),t.prototype.initView=function(){this.addBg(),this.addTitle(),this.addBtn()},t.prototype.addBg=function(){var t=Helper.getBitmap(R.begin_bg_jpg,720,1155);e.prototype.addChild.call(this,t)},t.prototype.addBtn=function(){var t=this;this.btn=Helper.getBitmap(R.begin_btn_png),Helper.ObjectCenterX(this.btn),this.btn.y=Helper.height-200,this.btn.y+=500,e.prototype.addChild.call(this,this.btn),this.btn.touchEnabled=!0,this.btn.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.dispatchEvent(t.tabEvent)},this)},t.prototype.addTitle=function(){this.title=Helper.getBitmap(R.begin_title_png),Helper.ObjectCenterX(this.title),this.title.y-=300,e.prototype.addChild.call(this,this.title)},t.prototype.beginAnimation=function(){egret.Tween.get(this.title).to({y:this.title.y+650},1e3,egret.Ease.sineOut),egret.Tween.get(this.btn).to({y:this.btn.y-500},1e3,egret.Ease.sineOut)},t.prototype.finishAnimation=function(e){egret.Tween.get(this.title).to({y:this.title.y-650},1e3,egret.Ease.sineIn),egret.Tween.get(this.btn).to({y:this.btn.y+500},1e3,egret.Ease.sineIn).call(e)},t.addBeginUI=function(e,n){var i=new t;e.addChild(i),i.beginAnimation(),i.addEventListener(TapEvent.NAME,function(){i.finishAnimation(function(){n(),e.removeChild(i)})},this)},t}(egret.Sprite);__reflect(BeginUI.prototype,"BeginUI");var BtnBreakUI=function(e){function t(){var t=e.call(this)||this,n=Helper.getBitmap(R.game_btn_break_png);return e.prototype.addChild.call(t,n),n.touchEnabled=!0,n.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){var n=Helper.getBitmap(R.chuizi_png);n.y-=100,e.prototype.addChild.call(t,n),egret.Tween.get(n).to({x:n.x-=150},100).to({x:0},100).call(function(){e.prototype.removeChild.call(t,n)})},t),t}return __extends(t,e),t}(egret.Sprite);__reflect(BtnBreakUI.prototype,"BtnBreakUI");var BtnGetUI=function(e){function t(){var t=e.call(this)||this,n=Helper.getBitmap(R.game_btn_get_png);return e.prototype.addChild.call(t,n),n.touchEnabled=!0,n.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){var n=Helper.getBitmap(R.hand_png);n.y-=100,e.prototype.addChild.call(t,n),egret.Tween.get(n).to({x:n.x+=150},100).to({x:0},100).call(function(){e.prototype.removeChild.call(t,n)})},t),t}return __extends(t,e),t}(egret.Sprite);__reflect(BtnGetUI.prototype,"BtnGetUI");var TimeOutEvent=function(e){function t(t,n,i){return void 0===n&&(n=!1),void 0===i&&(i=!1),e.call(this,t,n,i)||this}return __extends(t,e),t}(egret.Event);TimeOutEvent.NAME="TimeOutEvent",__reflect(TimeOutEvent.prototype,"TimeOutEvent");var GameUI=function(e){function t(){var t=e.call(this)||this;return t.rabbitEggList=new Array,t.initView(),t}return __extends(t,e),t.prototype.initView=function(){var e=this;this.addBg(),this.addBtn(),this.addBar();var t=new egret.Timer(500,0);t.addEventListener(egret.TimerEvent.TIMER,this.addRole,this),t.start();var n=new egret.Timer(1e3,0);n.addEventListener(egret.TimerEvent.TIMER,function(){e.barUI.timeTxt.text=new Number(e.barUI.timeTxt.text).valueOf()-1+"",new Number(e.barUI.timeTxt.text).valueOf()<1&&(t.stop(),n.stop(),e.dispatchEvent(new TimeOutEvent(TimeOutEvent.NAME)))},this),n.start()},t.prototype.addBg=function(){var t=Helper.getBitmap(R.begin_bg_jpg,720,1155);e.prototype.addChild.call(this,t)},t.prototype.addBtn=function(){var t=this,n=new BtnGetUI;Helper.ObjectCenterX(n),n.x-=253,n.y=Helper.height-184,n.touchEnabled=!0,n.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.btnTap(RoleType.rabbit)},this),e.prototype.addChild.call(this,n);var i=new BtnBreakUI;Helper.ObjectCenterX(i),i.x+=253,i.y=Helper.height-184,i.touchEnabled=!0,i.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.btnTap(RoleType.egg)},this),e.prototype.addChild.call(this,i)},t.prototype.addBar=function(){this.barUI=new BarUI,this.barUI.markTxt.text="0",this.barUI.timeTxt.text="25",e.prototype.addChild.call(this,this.barUI)},t.prototype.addRole=function(){var t,n=this,i=Math.floor(10*Math.random())%2;switch(i){case 0:t=new RabbitUI;break;default:t=new EggUI}Helper.ObjectCenterX(t);var r=t.x;t.y=600,t.scaleX=.3,t.scaleY=.3,t.x=.5*(Helper.width-.3*t.width),e.prototype.addChildAt.call(this,t,1),this.rabbitEggList.push(t),egret.Tween.get(t).to({y:Helper.height-300,scaleX:1,scaleY:1,x:r},1500,egret.Ease.circIn).to({y:Helper.height},500,egret.Ease.circInOut).call(function(){n.rabbitEggList.shift(),e.prototype.removeChild.call(n,t)})},t.addGameUI=function(e,n){var i=this,r=new t;e.addChild(r),r.addEventListener(TimeOutEvent.NAME,function(){var t=new ReGameUI(r.barUI.markTxt.text);e.addChild(t),t.addEventListener(TapEvent.NAME,function(){e.removeChild(t),e.removeChild(r),n()},i)},this)},t.prototype.btnTap=function(t){var n=this;this.rabbitEggList.forEach(function(i){if(i.hitTestPoint(Helper.width/2,Helper.height-165)){var r=i;if(t==r.roleType){n.barUI.markTxt.text=new Number(n.barUI.markTxt.text).valueOf()+10+"";var o=new egret.TextField;o.size=60,o.text="+10",o.textColor=16777215,Helper.ObjectCenter(o),e.prototype.addChild.call(n,o),egret.Tween.get(o).to({y:o.y-100},1e3).call(function(){e.prototype.removeChild.call(n,o)})}else{n.barUI.markTxt.text=new Number(n.barUI.markTxt.text).valueOf()-10+"";var a=new egret.TextField;a.size=60,a.text="-10",a.textColor=16711680,Helper.ObjectCenter(a),e.prototype.addChild.call(n,a),egret.Tween.get(a).to({y:a.y-100},1e3).call(function(){e.prototype.removeChild.call(n,a)})}}else;})},t}(egret.Sprite);__reflect(GameUI.prototype,"GameUI");var LoadingUI=function(e){function t(){var t=e.call(this)||this;return t.createView(),t}return __extends(t,e),t.prototype.createView=function(){for(var t=this,n=1;6>=n;n++){var i=Helper.getBitmap("pic"+n+"_png");i.name="pic"+n+"_png",Helper.ObjectCenter(i),i.visible=!1,e.prototype.addChild.call(this,i)}var r=new egret.Timer(100,0),o=0;r.addEventListener(egret.TimerEvent.TIMER,function(){o++;var n=o%6==0?6:o%6,i=e.prototype.getChildByName.call(t,"pic"+n+"_png");i.visible=!0,1==n?e.prototype.getChildByName.call(t,"pic6_png").visible=!1:e.prototype.getChildByName.call(t,"pic"+(n-1)+"_png").visible=!1},this),r.start()},t}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI");var RabbitUI=function(e){function t(){var t=e.call(this)||this;return t.roleType=RoleType.rabbit,t.initView(),t}return __extends(t,e),t.prototype.initView=function(){var t=Helper.getBitmap(R.rabbit_png);e.prototype.addChild.call(this,t)},t}(egret.Sprite);__reflect(RabbitUI.prototype,"RabbitUI");var ReGameUI=function(e){function t(t){var n=e.call(this)||this,i=new egret.Shape;i.graphics.beginFill(0,.8),i.graphics.drawRect(-1,-1,Helper.width+1,Helper.height+1),i.graphics.endFill(),i.touchEnabled=!0,e.prototype.addChild.call(n,i);var r=Helper.getBitmap(R.jieguo_bg_png);Helper.ObjectCenter(r),e.prototype.addChild.call(n,r);var o=Helper.getBitmap(R.restart_btn_png);Helper.ObjectCenter(o),o.y+=60,o.touchEnabled=!0,o.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){n.dispatchEvent(new TapEvent(TapEvent.NAME))},n),e.prototype.addChild.call(n,o);var a=Helper.getBitmap(R.jiangli_btn_png);Helper.ObjectCenter(a),a.y+=180,e.prototype.addChild.call(n,a);var p=new egret.TextField;p.textColor=16756224,p.size=50,p.text="恭喜您获得三等奖",Helper.ObjectCenter(p),p.y-=50,e.prototype.addChild.call(n,p);var l=new egret.TextField;return l.textColor=16777215,l.size=40,l.text="得分 "+t,Helper.ObjectCenter(l),l.y-=150,e.prototype.addChild.call(n,l),n}return __extends(t,e),t}(egret.Sprite);__reflect(ReGameUI.prototype,"ReGameUI");var Helper=function(){function e(){}return e.getBitmap=function(e,t,n,i,r){void 0===t&&(t=null),void 0===n&&(n=null),void 0===i&&(i=null),void 0===r&&(r=null);var o=new egret.Bitmap(RES.getRes(e));return null!=t&&(o.width=t),null!=n&&(o.height=n),null!=i&&(o.x=i),null!=r&&(o.y=r),o},e.ObjectCenterX=function(e){e.x=(this.width-e.width)/2},e.ObjectCenterY=function(e){e.y=(this.width-e.height)/2},e.ObjectCenter=function(e){e.x=(this.width-e.width)/2,e.y=(this.height-e.height)/2},e}();Helper.width=720,Helper.height=1155,__reflect(Helper.prototype,"Helper");var R=function(){function e(){}return e}();R.begin_bg_jpg="bg_png",R.begin_btn_png="begin_btn_png",R.game_bg_jpg="bg_png",R.begin_title_png="begin_title_png",R.game_btn_break_png="game_btn_break_png",R.game_btn_get_png="game_btn_get_png",R.egg_png="egg_png",R.rabbit_png="rabbit_png",R.great_bg_png="great_bg_png",R.hand_png="hand-_png",R.chuizi_png="chuizi_png",R.jieguo_bg_png="jieguo_bg_png",R.jiangli_btn_png="jiangli_btn_png",R.restart_btn_png="restart_btn_png",__reflect(R.prototype,"R");var RoleType;!function(e){e[e.rabbit=0]="rabbit",e[e.egg=1]="egg"}(RoleType||(RoleType={}));