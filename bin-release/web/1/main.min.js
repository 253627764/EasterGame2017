var __reflect=this&&this.__reflect||function(e,t,n){e.__class__=t,n?n.push(t):n=[t],e.__types__=e.__types__?n.concat(e.__types__):n},__extends=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},TapEvent=function(e){function t(t,n,i){return void 0===n&&(n=!1),void 0===i&&(i=!1),e.call(this,t,n,i)||this}return __extends(t,e),t}(egret.Event);TapEvent.NAME="TapEvent",__reflect(TapEvent.prototype,"TapEvent");var Main=function(e){function t(){var t=e.call(this)||this;return t.addEventListener(egret.Event.ADDED_TO_STAGE,t.onAddToStage,t),t}return __extends(t,e),t.prototype.onAddToStage=function(e){this.loadingView=new LoadingUI,this.stage.addChild(this.loadingView),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/")},t.prototype.onConfigComplete=function(e){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),RES.loadGroup("preload")},t.prototype.onResourceLoadComplete=function(e){"preload"==e.groupName&&(this.stage.removeChild(this.loadingView),RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),this.createGameScene())},t.prototype.onItemLoadError=function(e){console.warn("Url:"+e.resItem.url+" has failed to load")},t.prototype.onResourceLoadError=function(e){console.warn("Group:"+e.groupName+" has failed to load"),this.onResourceLoadComplete(e)},t.prototype.onResourceProgress=function(e){"preload"==e.groupName&&this.loadingView.setProgress(e.itemsLoaded,e.itemsTotal)},t.prototype.createGameScene=function(){Helper.width=this.stage.stageWidth,Helper.height=this.stage.stageHeight,this.addBeginUI(),RES.loadGroup("gameui")},t.prototype.addBeginUI=function(){var e=this;BeginUI.addBeginUI(this,function(){e.addGameUI()})},t.prototype.addGameUI=function(){GameUI.addGameUI(this,function(){})},t}(egret.DisplayObjectContainer);__reflect(Main.prototype,"Main");var BeginUI=function(e){function t(){var t=e.call(this)||this;return t.tabEvent=new TapEvent(TapEvent.NAME),t.initView(),t}return __extends(t,e),t.prototype.initView=function(){this.addBg(),this.addTitle(),this.addBtn()},t.prototype.addBg=function(){var t=Helper.getBitmap(R.begin_bg_jpg,720,1155);e.prototype.addChild.call(this,t)},t.prototype.addBtn=function(){var t=this;this.btn=Helper.getBitmap(R.begin_btn_png),Helper.ObjectCenterX(this.btn),this.btn.y=Helper.height-200,this.btn.y+=500,e.prototype.addChild.call(this,this.btn),this.btn.touchEnabled=!0,this.btn.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.dispatchEvent(t.tabEvent)},this)},t.prototype.addTitle=function(){this.title=Helper.getBitmap(R.begin_title_png),Helper.ObjectCenter(this.title),this.title.y-=1e3,e.prototype.addChild.call(this,this.title)},t.prototype.beginAnimation=function(){egret.Tween.get(this.title).to({y:this.title.y+1e3},1e3,egret.Ease.sineOut),egret.Tween.get(this.btn).to({y:this.btn.y-500},1e3,egret.Ease.sineOut)},t.prototype.finishAnimation=function(e){egret.Tween.get(this.title).to({y:this.title.y-1e3},1e3,egret.Ease.sineIn),egret.Tween.get(this.btn).to({y:this.btn.y+500},1e3,egret.Ease.sineIn).call(e)},t.addBeginUI=function(e,n){var i=new t;e.addChild(i),i.beginAnimation(),i.addEventListener(TapEvent.NAME,function(){i.finishAnimation(function(){n(),e.removeChild(i)})},this)},t}(egret.Sprite);__reflect(BeginUI.prototype,"BeginUI");var GameUI=function(e){function t(){var t=e.call(this)||this;return t.rabbitEggList=new Array,t.initView(),t}return __extends(t,e),t.prototype.initView=function(){this.addBg(),this.addBtn(),this.addTxt();var e=new egret.Timer(1e3,0);e.addEventListener(egret.TimerEvent.TIMER,this.addRole,this),e.start()},t.prototype.addBg=function(){var t=Helper.getBitmap(R.begin_bg_jpg,720,1155);e.prototype.addChild.call(this,t)},t.prototype.addBtn=function(){var t=this,n=Helper.getBitmap(R.game_btn_get_png);Helper.ObjectCenterX(n),n.x-=200,n.y=Helper.height-300,n.touchEnabled=!0,n.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.btnTap(RoleType.rabbit)},this),e.prototype.addChild.call(this,n);var i=Helper.getBitmap(R.game_btn_break_png);Helper.ObjectCenterX(i),i.x+=200,i.y=Helper.height-300,i.touchEnabled=!0,i.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.btnTap(RoleType.egg)},this),e.prototype.addChild.call(this,i)},t.prototype.addTxt=function(){this.markTxt=new egret.TextField,Helper.ObjectCenter(this.markTxt),this.markTxt.text="0",e.prototype.addChild.call(this,this.markTxt)},t.prototype.addRole=function(){var t,n=this,i=Math.floor(10*Math.random())%2;switch(i){case 0:t=Helper.getBitmap(R.rabbit_png),t.name=RoleType.rabbit;break;default:t=Helper.getBitmap(R.egg_png),t.name=RoleType.egg}Helper.ObjectCenterX(t);var r=t.x;t.y=400,t.scaleX=.3,t.scaleY=.3,t.x=.5*(Helper.width-.3*t.width),e.prototype.addChildAt.call(this,t,1),this.rabbitEggList.push(t),egret.Tween.get(t).to({y:Helper.height-400,scaleX:1,scaleY:1,x:r},2e3).to({y:Helper.height},500,egret.Ease.circInOut).call(function(){n.rabbitEggList.shift(),e.prototype.removeChild.call(n,t)})},t.addGameUI=function(e,n){var i=new t;e.addChild(i)},t.prototype.btnTap=function(e){var t=this;this.rabbitEggList.forEach(function(n){return n.hitTestPoint(Helper.width/2,Helper.height-250)?void(e==n.name?t.markTxt.text=new Number(t.markTxt.text).valueOf()+10+"":t.markTxt.text=new Number(t.markTxt.text).valueOf()-10+""):void 0})},t}(egret.Sprite);__reflect(GameUI.prototype,"GameUI");var LoadingUI=function(e){function t(){var t=e.call(this)||this;return t.createView(),t}return __extends(t,e),t.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=577.5,this.textField.width=720,this.textField.height=100,this.textField.textAlign="center"},t.prototype.setProgress=function(e,t){this.textField.text="Loading..."+e+"/"+t},t}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI");var Helper=function(){function e(){}return e.getBitmap=function(e,t,n,i,r){void 0===t&&(t=null),void 0===n&&(n=null),void 0===i&&(i=null),void 0===r&&(r=null);var o=new egret.Bitmap(RES.getRes(e));return null!=t&&(o.width=t),null!=n&&(o.height=n),null!=i&&(o.x=i),null!=r&&(o.y=r),o},e.ObjectCenterX=function(e){e.x=(this.width-e.width)/2},e.ObjectCenterY=function(e){e.y=(this.width-e.height)/2},e.ObjectCenter=function(e){e.x=(this.width-e.width)/2,e.y=(this.height-e.height)/2},e}();Helper.width=720,Helper.height=1155,__reflect(Helper.prototype,"Helper");var R=function(){function e(){}return e}();R.begin_bg_jpg="begin_bg_jpg",R.begin_btn_png="begin_btn_png",R.game_bg_jpg="game_bg_jpg",R.begin_title_png="begin_title_png",R.game_btn_break_png="game_btn_break_png",R.game_btn_get_png="game_btn_get_png",R.egg_png="egg_png",R.rabbit_png="rabbit_png",__reflect(R.prototype,"R");var RoleType=function(){function e(){}return e}();RoleType.rabbit="rabbit",RoleType.egg="egg",__reflect(RoleType.prototype,"RoleType");