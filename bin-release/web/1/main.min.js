var __reflect=this&&this.__reflect||function(e,t,i){e.__class__=t,i?i.push(t):i=[t],e.__types__=e.__types__?i.concat(e.__types__):i},__extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},GameUI=function(e){function t(){var t=e.call(this)||this;return t.rabbitEggList=new Array,t.timeSpan=0,t.eggMusicCan=!1,t.rabitMusicCan=!1,t.initView(),t}return __extends(t,e),t.prototype.initView=function(){var e=this;this.eggMusic=new egret.Sound,this.eggMusic.load("resource/assets/egg.mp3"),this.eggMusic.addEventListener(egret.Event.COMPLETE,function(){e.eggMusicCan=!0},this),this.rabitMusic=new egret.Sound,this.rabitMusic.load("resource/assets/rabit.wav"),this.rabitMusic.addEventListener(egret.Event.COMPLETE,function(){e.rabitMusicCan=!0},this),this.addBg(),this.addBtn(),this.addBar();var t=new egret.Timer(500,0);t.addEventListener(egret.TimerEvent.TIMER,this.addRole,this),t.start();var i=new egret.Timer(1e3,0);i.addEventListener(egret.TimerEvent.TIMER,function(){e.barUI.timeTxt.text=new Number(e.barUI.timeTxt.text).valueOf()-1+"",new Number(e.barUI.timeTxt.text).valueOf()<1&&(t.stop(),i.stop(),e.dispatchEvent(new TimeOutEvent(TimeOutEvent.NAME)))},this),i.start()},t.prototype.addBg=function(){var t=Helper.getBitmap(R.begin_bg_jpg,720,1155);e.prototype.addChild.call(this,t)},t.prototype.addBtn=function(){var t=this,i=new BtnGetUI;Helper.ObjectCenterX(i),i.x-=253,i.y=Helper.height-184,i.touchEnabled=!0,i.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.btnTap(RoleType.rabbit)},this),e.prototype.addChild.call(this,i);var n=new BtnBreakUI;Helper.ObjectCenterX(n),n.x+=253,n.y=Helper.height-184,n.touchEnabled=!0,n.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.btnTap(RoleType.egg)},this),e.prototype.addChild.call(this,n)},t.prototype.addBar=function(){this.barUI=new BarUI,this.barUI.markTxt.text="0",this.barUI.timeTxt.text="40",e.prototype.addChild.call(this,this.barUI)},t.prototype.addRole=function(){var t,i=this,n=Math.floor(10*Math.random())%2;switch(n){case 0:t=new RabbitUI;break;default:t=new EggUI}Helper.ObjectCenterX(t);var r=t.x;t.y=600,t.scaleX=.3,t.scaleY=.3,t.x=.5*(Helper.width-.3*t.width),e.prototype.addChildAt.call(this,t,1),this.rabbitEggList.push(t),egret.Tween.get(t).to({y:Helper.height-300,scaleX:1,scaleY:1,x:r},1800,egret.Ease.circIn).to({y:Helper.height},800,egret.Ease.circInOut).call(function(){i.rabbitEggList.shift(),e.prototype.removeChild.call(i,t)})},t.addGameUI=function(e,i){var n=this,r=new t;return e.addChild(r),r.addEventListener(TimeOutEvent.NAME,function(){var t=new ReGameUI(r.barUI.markTxt.text);e.addChild(t),t.addEventListener(TapEvent.NAME,function(){e.removeChild(t),e.removeChild(r),i()},n)},this),r},t.prototype.btnTap=function(t){var i=this;this.rabbitEggList.forEach(function(n){if(n.hitTestPoint(Helper.width/2,Helper.height-165)){var r=n,a=Date.now();if(a-i.timeSpan>400)if(i.timeSpan=a,t==r.roleType){i.barUI.markTxt.text=new Number(i.barUI.markTxt.text).valueOf()+10+"",r["break"](),r.roleType==RoleType.egg?i.eggMusicCan&&i.eggMusic.play(0,1):i.rabitMusicCan&&i.rabitMusic.play(0,1);var o=new egret.TextField;o.size=60,o.text="+10",o.textColor=16777215,Helper.ObjectCenter(o),e.prototype.addChild.call(i,o),egret.Tween.get(o).to({y:o.y-100},1e3).call(function(){e.prototype.removeChild.call(i,o)})}else if("0"!=i.barUI.markTxt.text){i.barUI.markTxt.text=new Number(i.barUI.markTxt.text).valueOf()-10+"";var l=new egret.TextField;l.size=60,l.text="-10",l.textColor=16711680,Helper.ObjectCenter(l),e.prototype.addChild.call(i,l),egret.Tween.get(l).to({y:l.y-100},1e3).call(function(){e.prototype.removeChild.call(i,l)})}}else;})},t}(egret.Sprite);__reflect(GameUI.prototype,"GameUI");var TapEvent=function(e){function t(t,i,n){return void 0===i&&(i=!1),void 0===n&&(n=!1),e.call(this,t,i,n)||this}return __extends(t,e),t}(egret.Event);TapEvent.NAME="TapEvent",__reflect(TapEvent.prototype,"TapEvent");var Main=function(e){function t(){var t=e.call(this)||this;return t.isfirst=!0,t.addEventListener(egret.Event.ADDED_TO_STAGE,t.onAddToStage,t),t}return __extends(t,e),t.prototype.onAddToStage=function(e){RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/")},t.prototype.onConfigComplete=function(e){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),RES.loadGroup("load")},t.prototype.onResourceLoadComplete=function(e){var t=this;"load"==e.groupName&&(this.loadingView=new LoadingUI,this.stage.addChild(this.loadingView),RES.loadGroup("preload")),"preload"==e.groupName&&(this.musicPlayUI=null==this.musicPlayUI?new MusicPlayUI:this.musicPlayUI,this.musicPlayUI.addEventListener(TimeOutEvent.NAME,function(){t.stage.removeChild(t.loadingView),RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,t.onResourceLoadComplete,t),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,t.onResourceLoadError,t),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,t.onItemLoadError,t),t.createGameScene()},this))},t.prototype.onItemLoadError=function(e){console.warn("Url:"+e.resItem.url+" has failed to load")},t.prototype.onResourceLoadError=function(e){console.warn("Group:"+e.groupName+" has failed to load"),this.onResourceLoadComplete(e)},t.prototype.createGameScene=function(){Helper.width=this.stage.stageWidth,Helper.height=this.stage.stageHeight,this.stage.scaleMode=egret.StageScaleMode.NO_BORDER,this.addBeginUI(),RES.loadGroup("gameui")},t.prototype.addBeginUI=function(){var e=this,t=BeginUI.addBeginUI(this,function(){e.addGameUI()});t.btn.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.musicPlayUI.musicControl=e.musicPlayUI.music.play()},this)},t.prototype.addGameUI=function(){var e=this;RES.loadGroup("regameui");var t=GameUI.addGameUI(this,function(){e.addBeginUI(),e.isfirst=!1,e.musicPlayUI.musicControl.stop()});t.addChild(this.musicPlayUI)},t}(egret.DisplayObjectContainer);__reflect(Main.prototype,"Main");var BarUI=function(e){function t(){var t=e.call(this)||this;return t.initView(),t}return __extends(t,e),t.prototype.initView=function(){var t=Helper.getBitmap(R.great_bg_png);Helper.ObjectCenterX(t),t.y+=30,e.prototype.addChild.call(this,t),this.markTxt=new egret.TextField,this.markTxt.y+=45,this.markTxt.x=250,e.prototype.addChild.call(this,this.markTxt),this.timeTxt=new egret.TextField,this.timeTxt.y+=45,this.timeTxt.x=520,e.prototype.addChild.call(this,this.timeTxt)},t}(egret.Sprite);__reflect(BarUI.prototype,"BarUI");var BeginUI=function(e){function t(){var t=e.call(this)||this;return t.tabEvent=new TapEvent(TapEvent.NAME),t.initView(),t}return __extends(t,e),t.prototype.initView=function(){this.addBg(),this.addTitle(),this.addBeginBtn()},t.prototype.addBg=function(){var t=Helper.getBitmap(R.begin_bg_jpg,720,1155);e.prototype.addChild.call(this,t)},t.prototype.addBeginBtn=function(){var t=this;this.btn=Helper.getBitmap(R.begin_btn_png),Helper.ObjectCenterX(this.btn),this.btn.y=Helper.height-200,this.btn.y+=500,e.prototype.addChild.call(this,this.btn),this.btn.touchEnabled=!0,this.btn.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.dispatchEvent(t.tabEvent)},this)},t.prototype.addTitle=function(){this.title=Helper.getBitmap(R.begin_title_png),Helper.ObjectCenterX(this.title),this.title.y-=300,e.prototype.addChild.call(this,this.title)},t.prototype.beginAnimation=function(){egret.Tween.get(this.title).to({y:this.title.y+650},1e3,egret.Ease.sineOut),egret.Tween.get(this.btn).to({y:this.btn.y-500},1e3,egret.Ease.sineOut)},t.prototype.finishAnimation=function(e){egret.Tween.get(this.title).to({y:this.title.y-650},1e3,egret.Ease.sineIn),egret.Tween.get(this.btn).to({y:this.btn.y+500},1e3,egret.Ease.sineIn).call(e)},t.addBeginUI=function(e,i){var n=new t;return e.addChild(n),n.beginAnimation(),n.addEventListener(TapEvent.NAME,function(){n.finishAnimation(function(){i(),e.removeChild(n)})},this),n},t}(egret.Sprite);__reflect(BeginUI.prototype,"BeginUI");var BtnBreakUI=function(e){function t(){var t=e.call(this)||this,i=Helper.getBitmap(R.game_btn_break_png);return e.prototype.addChild.call(t,i),i.touchEnabled=!0,i.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){var i=Helper.getBitmap(R.chuizi_png);i.y-=100,e.prototype.addChild.call(t,i),egret.Tween.get(i).to({x:i.x-=150},100).to({x:0},100).call(function(){e.prototype.removeChild.call(t,i)})},t),t}return __extends(t,e),t}(egret.Sprite);__reflect(BtnBreakUI.prototype,"BtnBreakUI");var BtnGetUI=function(e){function t(){var t=e.call(this)||this,i=Helper.getBitmap(R.game_btn_get_png);return e.prototype.addChild.call(t,i),i.touchEnabled=!0,i.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){var i=Helper.getBitmap(R.hand_png);i.y-=100,e.prototype.addChild.call(t,i),egret.Tween.get(i).to({x:i.x+=150},100).to({x:0},100).call(function(){e.prototype.removeChild.call(t,i)})},t),t}return __extends(t,e),t}(egret.Sprite);__reflect(BtnGetUI.prototype,"BtnGetUI");var EggUI=function(e){function t(){var t=e.call(this)||this;return t.roleType=RoleType.egg,t["break"]=function(){t.egg.visible=!1,t.eggBreak.visible=!0},t.initView(),t}return __extends(t,e),t.prototype.initView=function(){this.egg=Helper.getBitmap(R.egg_png),e.prototype.addChild.call(this,this.egg),this.eggBreak=Helper.getBitmap(R.eggbreak_png),this.eggBreak.visible=!1,e.prototype.addChild.call(this,this.eggBreak)},t}(egret.Sprite);__reflect(EggUI.prototype,"EggUI");var TimeOutEvent=function(e){function t(t,i,n){return void 0===i&&(i=!1),void 0===n&&(n=!1),e.call(this,t,i,n)||this}return __extends(t,e),t}(egret.Event);TimeOutEvent.NAME="TimeOutEvent",__reflect(TimeOutEvent.prototype,"TimeOutEvent");var LoadingUI=function(e){function t(){var t=e.call(this)||this;return t.createView(),t}return __extends(t,e),t.prototype.createView=function(){for(var t=this,i=1;6>=i;i++){var n=Helper.getBitmap("pic"+i+"_png");n.name="pic"+i+"_png",Helper.ObjectCenter(n),n.visible=!1,e.prototype.addChild.call(this,n)}var r=new egret.Timer(100,0),a=0;r.addEventListener(egret.TimerEvent.TIMER,function(){a++;var i=a%6==0?6:a%6,n=e.prototype.getChildByName.call(t,"pic"+i+"_png");n.visible=!0,1==i?e.prototype.getChildByName.call(t,"pic6_png").visible=!1:e.prototype.getChildByName.call(t,"pic"+(i-1)+"_png").visible=!1},this),r.start()},t}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI");var MusicPlayUI=function(e){function t(){var t=e.call(this)||this;return t.music=new egret.Sound,t.music.load("resource/assets/pz.mp3"),t.music.addEventListener(egret.Event.COMPLETE,function(){var i=Helper.getBitmap("icon_music_open_png",null,null,60,60);i.anchorOffsetX=i.width/2,i.anchorOffsetY=i.height/2,i.touchEnabled=!0,e.prototype.addChild.call(t,i);var n=Helper.getBitmap("icon_music_close_png",null,null,60,60);n.anchorOffsetX=i.width/2,n.anchorOffsetY=i.height/2,n.visible=!1,n.touchEnabled=!0,e.prototype.addChild.call(t,n);var r=new egret.Timer(20,0),a=0;r.addEventListener(egret.TimerEvent.TIMER,function(){i.rotation=a++},t),r.start(),i.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){r.stop(),n.visible=!0,i.visible=!1,t.musicControl.stop()},t),n.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){n.visible=!1,i.visible=!0,r.start(),t.musicControl=t.music.play()},t),t.dispatchEvent(new TimeOutEvent(TimeOutEvent.NAME))},t),t}return __extends(t,e),t}(egret.Sprite);__reflect(MusicPlayUI.prototype,"MusicPlayUI");var RabbitUI=function(e){function t(){var t=e.call(this)||this;return t.roleType=RoleType.rabbit,t["break"]=function(){t.rabbit.visible=!1,t.rabbitBreak.visible=!0},t.initView(),t}return __extends(t,e),t.prototype.initView=function(){this.rabbit=Helper.getBitmap(R.rabbit_png),e.prototype.addChild.call(this,this.rabbit),this.rabbitBreak=Helper.getBitmap(R.rabit_taked_png),this.rabbitBreak.visible=!1,e.prototype.addChild.call(this,this.rabbitBreak)},t}(egret.Sprite);__reflect(RabbitUI.prototype,"RabbitUI");var ReGameUI=function(e){function t(t){var i=e.call(this)||this,n=new egret.Shape;n.graphics.beginFill(0,.8),n.graphics.drawRect(-1,-1,Helper.width+1,Helper.height+1),n.graphics.endFill(),n.touchEnabled=!0,e.prototype.addChild.call(i,n);var r=Helper.getBitmap(R.jieguo_bg_png);Helper.ObjectCenter(r),e.prototype.addChild.call(i,r);var a=Helper.getBitmap(R.restart_btn_png);Helper.ObjectCenter(a),a.y+=60,a.touchEnabled=!0,a.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){i.dispatchEvent(new TapEvent(TapEvent.NAME))},i),e.prototype.addChild.call(i,a);var o=Helper.getBitmap(R.jiangli_btn_png);Helper.ObjectCenter(o),o.y+=180,e.prototype.addChild.call(i,o);var l=new egret.TextField;l.textColor=16756224,l.size=50,l.text="恭喜您获得三等奖",Helper.ObjectCenter(l),l.y-=50,e.prototype.addChild.call(i,l);var p=new egret.TextField;return p.textColor=16777215,p.size=40,p.text="得分 "+t,Helper.ObjectCenter(p),p.y-=150,e.prototype.addChild.call(i,p),i}return __extends(t,e),t}(egret.Sprite);__reflect(ReGameUI.prototype,"ReGameUI");var Helper=function(){function e(){}return e.getBitmap=function(e,t,i,n,r){void 0===t&&(t=null),void 0===i&&(i=null),void 0===n&&(n=null),void 0===r&&(r=null);var a=new egret.Bitmap(RES.getRes(e));return null!=t&&(a.width=t),null!=i&&(a.height=i),null!=n&&(a.x=n),null!=r&&(a.y=r),a},e.ObjectCenterX=function(e){e.x=(this.width-e.width)/2},e.ObjectCenterY=function(e){e.y=(this.width-e.height)/2},e.ObjectCenter=function(e){e.x=(this.width-e.width)/2,e.y=(this.height-e.height)/2},e}();Helper.width=720,Helper.height=1155,__reflect(Helper.prototype,"Helper");var R=function(){function e(){}return e}();R.begin_bg_jpg="bg_png",R.begin_btn_png="begin_btn_png",R.game_bg_jpg="bg_png",R.begin_title_png="begin_title_png",R.game_btn_break_png="game_btn_break_png",R.game_btn_get_png="game_btn_get_png",R.egg_png="egg_png",R.rabbit_png="rabbit_png",R.eggbreak_png="egg-break_png",R.rabit_taked_png="rabit_taked_png",R.great_bg_png="great_bg_png",R.hand_png="hand-_png",R.chuizi_png="chuizi_png",R.jieguo_bg_png="jieguo_bg_png",R.jiangli_btn_png="jiangli_btn_png",R.restart_btn_png="restart_btn_png",__reflect(R.prototype,"R");var RoleType;!function(e){e[e.rabbit=0]="rabbit",e[e.egg=1]="egg"}(RoleType||(RoleType={}));